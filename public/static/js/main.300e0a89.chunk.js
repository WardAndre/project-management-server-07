(this["webpackJsonpproject-management-client-07"]=this["webpackJsonpproject-management-client-07"]||[]).push([[0],{35:function(e,t,a){e.exports=a(65)},40:function(e,t,a){},41:function(e,t,a){},65:function(e,t,a){"use strict";a.r(t);var n=a(0),s=a.n(n),r=a(30),l=a.n(r),i=(a(40),a(2)),c=a(3),o=a(1),m=a(5),u=a(4),h=(a(41),a(8)),p=a.n(h),d=a(6),g=a(11),v=function(e){Object(m.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(i.a)(this,a),(n=t.call(this,e)).state={title:"",description:"",imageUrl:"",originalName:""},n.handleFormSubmit=n.handleFormSubmit.bind(Object(o.a)(n)),n.handleChange=n.handleChange.bind(Object(o.a)(n)),n.handleFileChange=n.handleFileChange.bind(Object(o.a)(n)),n}return Object(c.a)(a,[{key:"handleFormSubmit",value:function(e){var t=this;e.preventDefault();var a=this.state,n=a.title,s=a.description,r=a.imageUrl;p.a.post("https://project-management-07.herokuapp.com/api/projects",{title:n,description:s,imageUrl:r},{withCredentials:!0}).then((function(){t.props.getData(),t.setState({title:"",description:"",originalName:"",imageUrl:""})})).catch((function(e){return console.log(e)}))}},{key:"handleChange",value:function(e){var t=e.target,a=t.name,n=t.value;this.setState(Object(g.a)({},a,n))}},{key:"handleFileChange",value:function(e){var t=this,a=new FormData;a.append("imageUrl",e.target.files[0]),p.a.post("https://project-management-07.herokuapp.com/api/upload",a).then((function(e){return t.setState({imageUrl:e.data.secure_url,originalName:e.data.originalName})})).catch((function(e){return console.log(e)}))}},{key:"render",value:function(){return s.a.createElement("div",{className:"section"},s.a.createElement("form",{onSubmit:this.handleFormSubmit},s.a.createElement("div",{className:"field"},s.a.createElement("div",{className:"control"},s.a.createElement("label",{className:"label"},"Title"),s.a.createElement("input",{className:"input is-small",type:"text",name:"title",value:this.state.title,onChange:this.handleChange}))),s.a.createElement("div",{className:"field"},s.a.createElement("div",{className:"control"},s.a.createElement("label",{className:"label"},"Description"),s.a.createElement("textarea",{className:"textarea",name:"description",value:this.state.description,onChange:this.handleChange}))),s.a.createElement("div",{className:"field"},s.a.createElement("div",{className:"file has-name is-boxed"},s.a.createElement("label",{className:"file-label"},s.a.createElement("input",{className:"file-input",type:"file",name:"imageUrl",onChange:this.handleFileChange}),s.a.createElement("span",{className:"file-cta"},s.a.createElement("span",{className:"file-icon"},s.a.createElement("i",{className:"fas fa-upload"})),s.a.createElement("span",{className:"file-label"},"Choose a file\u2026")),s.a.createElement("span",{className:"file-name"},this.state.originalName&&this.state.originalName)))),s.a.createElement("input",{className:"button",type:"submit",value:"Submit"})))}}]),a}(n.Component),b=function(e){Object(m.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(i.a)(this,a),(n=t.call(this,e)).state={listOfProjects:[]},n.getAllProjects=n.getAllProjects.bind(Object(o.a)(n)),n}return Object(c.a)(a,[{key:"getAllProjects",value:function(){var e=this;p.a.get("".concat("https://project-management-07.herokuapp.com/api","/projects"),{withCredentials:!0}).then((function(t){e.setState({listOfProjects:t.data})}))}},{key:"componentDidMount",value:function(){this.getAllProjects()}},{key:"render",value:function(){return s.a.createElement("div",null,s.a.createElement("div",{style:{width:"60%",float:"left"}},this.state.listOfProjects.map((function(e){return s.a.createElement("div",{key:e._id},s.a.createElement("h3",{className:"title is-2"},s.a.createElement(d.b,{to:"/projects/".concat(e._id)},e.title)),s.a.createElement("figure",{className:"image is-4by3"},e.imageUrl?s.a.createElement("img",{src:e.imageUrl,alt:e.title}):s.a.createElement("img",{src:"https://versions.bulma.io/0.7.0/images/placeholders/256x256.png",alt:e.title})),s.a.createElement("p",{className:"content",style:{maxWidth:"400px"}},e.description),s.a.createElement("ul",{className:"section"},e.tasks.length>0&&s.a.createElement(s.a.Fragment,null,s.a.createElement("h5",{className:"title is-5"},"tasks"),e.tasks.map((function(t,a){return s.a.createElement("li",{key:a,className:"subtitle is-5"},s.a.createElement(d.b,{to:"/projects/".concat(e._id,"/tasks/").concat(t._id)},t.title))})))))}))),s.a.createElement("div",{style:{width:"40%",float:"right"}},s.a.createElement(v,{getData:this.getAllProjects})))}}]),a}(n.Component),f=function(){function e(){Object(i.a)(this,e),this.service=p.a.create({baseURL:"https://project-management-07.herokuapp.com/api",withCredentials:!0})}return Object(c.a)(e,[{key:"signup",value:function(e,t){return this.service.post("/signup",{username:e,password:t}).then((function(e){return e.data}))}},{key:"login",value:function(e,t){return this.service.post("/login",{username:e,password:t}).then((function(e){return e.data}))}},{key:"loggedin",value:function(){return this.service.get("/loggedin").then((function(e){return e.data}))}},{key:"logout",value:function(){return this.service.get("/logout").then((function(e){return e.data}))}}]),e}(),E=function(e){Object(m.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(i.a)(this,a),(n=t.call(this,e)).state={loggedInUser:null},n.service=new f,n.logoutUser=n.logoutUser.bind(Object(o.a)(n)),n}return Object(c.a)(a,[{key:"componentDidUpdate",value:function(e){this.props.userInSession!==e.userInSession&&this.setState({loggedInUser:this.props.userInSession})}},{key:"logoutUser",value:function(){var e=this;this.service.logout().then((function(){e.setState({loggedInUser:null}),e.props.getUser(null)}))}},{key:"render",value:function(){return this.state.loggedInUser?s.a.createElement("nav",{className:"navbar is-fixed-top is-mobile",role:"navigation","aria-label":"main navigation"},s.a.createElement("div",{className:"navbar-menu"},s.a.createElement("div",{className:"navbar-start"},s.a.createElement(d.c,{className:"navbar-item",activeClassName:"is-active",to:"/projects"},"Projects"))),s.a.createElement("div",{className:"navbar-end"},s.a.createElement("div",{className:"navbar-item"},"Welcome, ",this.state.loggedInUser.username),s.a.createElement("div",{className:"navbar-item"},s.a.createElement("button",{className:"button is-small",onClick:this.logoutUser},"Logout")))):s.a.createElement("nav",{className:"navbar is-fixed-top is-mobile",role:"navigation","aria-label":"main navigation"},s.a.createElement("div",{className:"navbar-menu"},s.a.createElement("div",{className:"navbar-start"},s.a.createElement(d.c,{className:"navbar-item",activeClassName:"is-active",to:"/"},"Login"),s.a.createElement(d.c,{className:"navbar-item",activeClassName:"is-active",to:"/signup"},"Signup"))))}}]),a}(n.Component),j=a(14),N=function(e){Object(m.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(i.a)(this,a),(n=t.call(this,e)).state={title:n.props.theProject.title,description:n.props.theProject.description,imageUrl:n.props.theProject.imageUrl,originalName:""},n.handleFormSubmit=n.handleFormSubmit.bind(Object(o.a)(n)),n.handleChange=n.handleChange.bind(Object(o.a)(n)),n.handleFileChange=n.handleFileChange.bind(Object(o.a)(n)),n}return Object(c.a)(a,[{key:"handleFormSubmit",value:function(e){var t=this,a=this.state,n=a.title,s=a.description,r=a.imageUrl;e.preventDefault(),p.a.put("".concat("https://project-management-07.herokuapp.com/api","/projects/").concat(this.props.theProject._id),{title:n,description:s,imageUrl:r},{withCredentials:!0}).then((function(){t.props.getTheProject(),t.props.history.push("/projects")})).catch((function(e){return console.log(e)}))}},{key:"handleChange",value:function(e){var t=e.target,a=t.value,n=t.name;this.setState(Object(g.a)({},n,a))}},{key:"handleFileChange",value:function(e){var t=this,a=new FormData;a.append("imageUrl",e.target.files[0]),p.a.post("https://project-management-07.herokuapp.com/api/upload",a,{withCredentials:!0}).then((function(e){return t.setState({imageUrl:e.data.secure_url,originalName:e.data.originalName})})).catch((function(e){return console.log(e)}))}},{key:"render",value:function(){return s.a.createElement("div",{className:"section"},s.a.createElement("hr",null),s.a.createElement("h3",{className:"title is-3"},"Edit form"),s.a.createElement("form",{onSubmit:this.handleFormSubmit},s.a.createElement("div",{className:"field"},s.a.createElement("div",{className:"control"},s.a.createElement("label",{className:"label"},"Title"),s.a.createElement("input",{className:"input is-small",type:"text",name:"title",value:this.state.title,onChange:this.handleChange}))),s.a.createElement("div",{className:"field"},s.a.createElement("div",{className:"control"},s.a.createElement("label",{className:"label"},"Description"),s.a.createElement("textarea",{className:"textarea",name:"description",value:this.state.description,onChange:this.handleChange}))),s.a.createElement("div",{className:"field"},s.a.createElement("div",{className:"file has-name is-boxed"},s.a.createElement("label",{className:"file-label"},s.a.createElement("input",{className:"file-input",type:"file",name:"imageUrl",onChange:this.handleFileChange}),s.a.createElement("span",{className:"file-cta"},s.a.createElement("span",{className:"file-icon"},s.a.createElement("i",{className:"fas fa-upload"})),s.a.createElement("span",{className:"file-label"},"Choose a file\u2026")),s.a.createElement("span",{className:"file-name"},this.state.originalName&&this.state.originalName)))),s.a.createElement("input",{className:"button",type:"submit",value:"Submit"})))}}]),a}(n.Component),k=function(e){Object(m.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(i.a)(this,a),(n=t.call(this,e)).state={title:"",description:"",isShowing:!1},n.handleFormSubmit=n.handleFormSubmit.bind(Object(o.a)(n)),n.handleChange=n.handleChange.bind(Object(o.a)(n)),n.showAddTaskForm=n.showAddTaskForm.bind(Object(o.a)(n)),n.toggleForm=n.toggleForm.bind(Object(o.a)(n)),n}return Object(c.a)(a,[{key:"handleFormSubmit",value:function(e){var t=this;e.preventDefault();var a=this.state.title,n=this.state.description,s=this.props.theProject._id;p.a.post("https://project-management-07.herokuapp.com/api/tasks",{title:a,description:n,projectID:s},{withCredentials:!0}).then((function(){t.props.getTheProject(),t.setState({title:"",description:""})})).catch((function(e){return console.log(e)}))}},{key:"handleChange",value:function(e){var t=e.target,a=t.name,n=t.value;this.setState(Object(g.a)({},a,n))}},{key:"toggleForm",value:function(){this.setState((function(e){return{isShowing:!e.isShowing}}))}},{key:"showAddTaskForm",value:function(){if(this.state.isShowing)return s.a.createElement("div",{className:"section"},s.a.createElement("h3",{className:"title is-3"},"Add Task"),s.a.createElement("form",{onSubmit:this.handleFormSubmit},s.a.createElement("div",{className:"field"},s.a.createElement("div",{className:"control"},s.a.createElement("label",{className:"label"},"Title"),s.a.createElement("input",{className:"input is-small",type:"text",name:"title",value:this.state.title,onChange:this.handleChange}))),s.a.createElement("div",{className:"field"},s.a.createElement("div",{className:"control"},s.a.createElement("label",{className:"label"},"Description"),s.a.createElement("textarea",{className:"textarea",name:"description",value:this.state.description,onChange:this.handleChange}))),s.a.createElement("input",{className:"button",type:"submit",value:"Submit"})))}},{key:"render",value:function(){var e=this;return s.a.createElement("div",null,s.a.createElement("hr",null),s.a.createElement("button",{className:"button",onClick:function(){return e.toggleForm()}},"Add task"),this.showAddTaskForm())}}]),a}(n.Component),O=function(e){Object(m.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(i.a)(this,a),(n=t.call(this,e)).state={project:null},n.getSingleProject=n.getSingleProject.bind(Object(o.a)(n)),n.deleteProject=n.deleteProject.bind(Object(o.a)(n)),n}return Object(c.a)(a,[{key:"getSingleProject",value:function(){var e=this;console.log(this.props);var t=this.props.match.params.id;p.a.get("https://project-management-07.herokuapp.com/api/projects/"+t,{withCredentials:!0}).then((function(t){return e.setState({project:t.data})})).catch((function(e){return console.log(e)}))}},{key:"componentDidMount",value:function(){this.getSingleProject()}},{key:"deleteProject",value:function(){var e=this;p.a.delete("https://project-management-07.herokuapp.com/api/projects/"+this.state.project._id,{withCredentials:!0}).then((function(){return e.props.history.push("/projects")})).catch((function(e){return console.log(e)}))}},{key:"ownershipCheck",value:function(e){if(this.props.loggedInUser&&e.owner===this.props.loggedInUser._id)return s.a.createElement("div",null,s.a.createElement("div",null,s.a.createElement(N,Object.assign({theProject:this.state.project,getTheProject:this.getSingleProject},this.props))),s.a.createElement("button",{className:"button",onClick:this.deleteProject},"Delete project"))}},{key:"render",value:function(){var e=this.state.project;return s.a.createElement("div",null,e?s.a.createElement(s.a.Fragment,null,s.a.createElement("h1",{className:"title is-1"},e.title),s.a.createElement("figure",{className:"image is-4by3"},e.imageUrl?s.a.createElement("img",{src:e.imageUrl,alt:e.title}):s.a.createElement("img",{src:"https://versions.bulma.io/0.7.0/images/placeholders/256x256.png",alt:e.title})),s.a.createElement("p",null,e.description),s.a.createElement("h2",null,"Tasks"),s.a.createElement("ul",null,e.tasks.map((function(t,a){return s.a.createElement("li",{key:a},s.a.createElement(d.b,{to:"/projects/".concat(e._id,"/tasks/").concat(t._id)},t.title))}))),this.ownershipCheck(e),s.a.createElement("br",null),s.a.createElement(k,{theProject:e,getTheProject:this.getSingleProject}),s.a.createElement("br",null),s.a.createElement(d.b,{to:"/projects"},"Back to projects")):s.a.createElement("h4",null,"loading..."))}}]),a}(n.Component),C=function(e){Object(m.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(i.a)(this,a),(n=t.call(this,e)).state={},n.getTheTask=n.getTheTask.bind(Object(o.a)(n)),n}return Object(c.a)(a,[{key:"componentDidMount",value:function(){this.getTheTask()}},{key:"getTheTask",value:function(){var e=this,t=this.props.match.params;p.a.get("".concat("https://project-management-07.herokuapp.com/api","/projects/").concat(t.id,"/tasks/").concat(t.taskId),{withCredentials:!0}).then((function(t){var a=t.data;e.setState(a)})).catch((function(e){console.log(e)}))}},{key:"render",value:function(){return s.a.createElement("div",null,this.state.project&&s.a.createElement(s.a.Fragment,null,s.a.createElement("h1",null,this.state.title),s.a.createElement("p",null,this.state.description),s.a.createElement(d.b,{to:"/projects/".concat(this.state.project._id)},"Back to project")))}}]),a}(n.Component),U=function(e){Object(m.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(i.a)(this,a),(n=t.call(this,e)).state={username:"",password:"",errorMsgUsername:null,errorMsgPassword:null},n.service=new f,n.handleFormSubmit=n.handleFormSubmit.bind(Object(o.a)(n)),n.handleChange=n.handleChange.bind(Object(o.a)(n)),n}return Object(c.a)(a,[{key:"handleFormSubmit",value:function(e){var t=this;e.preventDefault();var a=this.state.username,n=this.state.password;this.service.signup(a,n).then((function(e){t.setState({username:"",password:"",errorMsgUsername:null,errorMsgPassword:null}),console.log(e),t.props.getUser(e),t.props.history.push("/projects")})).catch((function(e){var a=e.response.data.message;a.includes("password")?t.setState({errorMsgPassword:a}):t.setState({errorMsgUsername:a}),console.log(a)}))}},{key:"handleChange",value:function(e){var t=e.target,a=t.name,n=t.value;this.setState(Object(g.a)({},a,n))}},{key:"render",value:function(){return s.a.createElement("div",{className:"section"},s.a.createElement("form",{onSubmit:this.handleFormSubmit},s.a.createElement("div",{className:"field"},s.a.createElement("div",{className:"control"},s.a.createElement("label",{className:"label"},"Username"),s.a.createElement("input",{className:"input is-small",type:"text",name:"username",value:this.state.username,onChange:this.handleChange})),this.state.errorMsgUsername&&s.a.createElement("p",{className:"help is-danger"},this.state.errorMsgUsername)),s.a.createElement("div",{className:"field"},s.a.createElement("div",{className:"control"},s.a.createElement("label",{className:"label"},"Password"),s.a.createElement("input",{className:"input is-small",type:"password",name:"password",value:this.state.password,onChange:this.handleChange})),this.state.errorMsgPassword&&s.a.createElement("p",{className:"help is-danger"},this.state.errorMsgPassword)),s.a.createElement("input",{className:"button",type:"submit",value:"Signup"})),s.a.createElement("p",null,"Already have account?",s.a.createElement(d.b,{to:"/"}," Login")))}}]),a}(n.Component),S=function(e){Object(m.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(i.a)(this,a),(n=t.call(this,e)).state={username:"",password:"",errorMsgUsername:null,errorMsgPassword:null},n.service=new f,n.handleFormSubmit=n.handleFormSubmit.bind(Object(o.a)(n)),n.handleChange=n.handleChange.bind(Object(o.a)(n)),n}return Object(c.a)(a,[{key:"handleFormSubmit",value:function(e){var t=this;e.preventDefault();var a=this.state.username,n=this.state.password;this.service.login(a,n).then((function(e){var a="/projects";t.setState({username:"",password:"",errorMsgUsername:null,errorMsgPassword:null}),t.props.getUser(e),t.props.location.state&&(a=t.props.location.state.from.pathname),t.props.history.push(a)})).catch((function(e){var a=e.response.data.message;a.endsWith("password.")?t.setState({errorMsgPassword:a}):t.setState({errorMsgUsername:a}),console.log(e.response,a)}))}},{key:"handleChange",value:function(e){var t=e.target,a=t.name,n=t.value;this.setState(Object(g.a)({},a,n))}},{key:"render",value:function(){var e=this.state,t=e.errorMsgUsername,a=e.errorMsgPassword,n=t?"".concat("input is-small"," is-danger"):"input is-small",r=a?"".concat("input is-small"," is-danger"):"input is-small";return s.a.createElement("div",{className:"section"},s.a.createElement("form",{onSubmit:this.handleFormSubmit},s.a.createElement("div",{className:"field"},s.a.createElement("div",{className:"control"},s.a.createElement("label",{className:"label"},"Username"),s.a.createElement("input",{className:n,type:"text",name:"username",value:this.state.username,onChange:this.handleChange})),t&&s.a.createElement("p",{className:"help is-danger"},this.state.errorMsgUsername)),s.a.createElement("div",{className:"field"},s.a.createElement("div",{className:"control"},s.a.createElement("label",{className:"label"},"Password"),s.a.createElement("input",{className:r,type:"password",name:"password",value:this.state.password,onChange:this.handleChange})),a&&s.a.createElement("p",{className:"help is-danger"},this.state.errorMsgPassword)),s.a.createElement("input",{className:"button",type:"submit",value:"Login"})),s.a.createElement("p",null,"Don't have an account?",s.a.createElement(d.b,{to:"/signup"}," Signup")))}}]),a}(n.Component),y=a(33),w=a(34),P=function(e){var t=e.component,a=e.user,n=Object(w.a)(e,["component","user"]);return console.log(Object(y.a)({component:t,user:a},n)),s.a.createElement(j.b,Object.assign({},n,{render:function(e){return a?s.a.createElement(t,Object.assign({},e,{loggedInUser:a})):s.a.createElement(j.a,{to:{pathname:"/",state:{from:e.location}}})}}))},F=function(e){Object(m.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(i.a)(this,a),(n=t.call(this,e)).state={loggedInUser:null},n.service=new f,n.getTheUser=n.getTheUser.bind(Object(o.a)(n)),n}return Object(c.a)(a,[{key:"fetchUser",value:function(){var e=this;null===this.state.loggedInUser&&this.service.loggedin().then((function(t){e.setState({loggedInUser:t})})).catch((function(t){e.setState({loggedInUser:!1})}))}},{key:"getTheUser",value:function(e){this.setState({loggedInUser:e})}},{key:"render",value:function(){var e=this;return this.fetchUser(),this.state.loggedInUser?s.a.createElement("div",{className:"section"},s.a.createElement(E,{userInSession:this.state.loggedInUser,getUser:this.getTheUser}),s.a.createElement("div",{className:"container"},s.a.createElement(j.d,null,s.a.createElement(P,{exact:!0,user:this.state.loggedInUser,path:"/projects/:id",component:O}),s.a.createElement(P,{exact:!0,user:this.state.loggedInUser,path:"/projects",component:b}),s.a.createElement(P,{user:this.state.loggedInUser,exact:!0,path:"/projects/:id/tasks/:taskId",component:C})))):s.a.createElement("div",{className:"section"},s.a.createElement(E,{userInSession:this.state.loggedInUser,getUser:this.getTheUser}),s.a.createElement("div",{className:"container"},s.a.createElement(j.d,null,s.a.createElement(j.b,{exact:!0,path:"/",render:function(t){return s.a.createElement(S,Object.assign({getUser:e.getTheUser},t))}}),s.a.createElement(j.b,{exact:!0,path:"/signup",render:function(t){return s.a.createElement(U,Object.assign({getUser:e.getTheUser},t))}}),s.a.createElement(P,{exact:!0,user:this.state.loggedInUser,path:"/projects/:id",component:O}),s.a.createElement(P,{exact:!0,user:this.state.loggedInUser,path:"/projects",component:b}),s.a.createElement(P,{user:this.state.loggedInUser,exact:!0,path:"/projects/:id/tasks/:taskId",component:C}))))}}]),a}(n.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));a(64);l.a.render(s.a.createElement(s.a.StrictMode,null,s.a.createElement(d.a,null,s.a.createElement(F,null))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[35,1,2]]]);
//# sourceMappingURL=main.300e0a89.chunk.js.map